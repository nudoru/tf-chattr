/*! app-framework 25-07-2015 */
define("APP.Application",function(a,b,c){function d(){var b,c;e=this,b=this.createApplicationModel(a("APP.Model.AppModel")),c=this.createApplicationView(a("APP.View.AppView")),this.initializeApplication({model:b,view:c}),this.view().initialize(),this.model().initialize(),this.view().removeLoadingMessage(),this.setCurrentRoute(APP.router().getCurrentRoute()),this.view().render()}var e;c.initialize=d}),define("App.Events.EventConstants",function(a,b,c){var d=a("Nudoru.Core.ObjectUtils");_.merge(c,d.keyMirror({PUBLISH_MESSAGE:null,NICK_UPDATE:null}))}),define("App.Events.EventCreator",function(a,b,c){var d=a("Nori.Utils.Dispatcher"),e=a("App.Events.EventConstants");c.publishMessage=function(a,b){d.publish({type:e.PUBLISH_MESSAGE,payload:{username:a,message:b}})},c.updateNick=function(a){d.publish({type:e.NICK_UPDATE,payload:{nick:a}})}}),define("APP.Model.AppModel",function(a,b,c){function d(){k=this,q.subscribe(p.PUBLISH_MESSAGE,j),l=k.createMapCollection({id:"UsersCollection"}),m=k.createMapCollection({id:"MessagesCollection"}),g("Sophie"),g("Gabe"),g("Casey"),g("Matt"),i("System","Welcome to Chattr! Start chatting..."),n.applicationModelInitialized()}function e(){return l}function f(){return m}function g(a){l.add(k.createMap({id:a,store:{username:a}}))}function h(a){l.remove(a)}function i(a,b){a=a||"Unknown",m.add(k.createMap({id:o++,store:{username:a,content:b}}))}function j(a){i(a.payload.username,a.payload.message)}var k,l,m,n=a("Nori.Events.AppEventCreator"),o=1,p=a("App.Events.EventConstants"),q=a("Nori.Utils.Dispatcher");c.initialize=d,c.getUsersCollection=e,c.getMessagesCollection=f,c.addUser=g,c.removeUser=h,c.addMessage=i}),define("APP.View.AppSubView",function(a,b,c){function d(a){this.isInitialized()||this.initializeSubView(a)}function e(){}c.initialize=d,c.viewWillUpdate=e}),define("APP.View.AppView",function(a,b,c){function d(){l=this,l.initializeApplicationView(["applicationscaffold","applicationcomponentsscaffold"]),l.setRouteViewMountPoint("#contents"),k(),APP.mapRouteView("/","default","APP.View.AppSubView"),m.applicationViewInitialized()}function e(){l.setEvents({"change #nick-input":f,"change #message-input":g}),l.delegateEvents(),l.createComponent("user-list","APP.View.UserList","#users"),l.createComponent("message-list","APP.View.MessageList","#message"),l.renderComponent("user-list"),l.renderComponent("message-list")}function f(a){p.updateNick(a.target.value)}function g(){p.publishMessage(h(),i()),j()}function h(){return document.getElementById("nick-input").value}function i(){return document.getElementById("message-input").value}function j(){return document.getElementById("message-input").value=""}function k(){n.subscribe(o.NOTIFY_USER,function(a){l.notify(a.payload.message,a.payload.title,a.payload.type)}),n.subscribe(o.ALERT_USER,function(a){l.alert(a.payload.message,a.payload.title)})}{var l,m=a("Nori.Events.AppEventCreator"),n=a("Nori.Utils.Dispatcher"),o=a("Nori.Events.AppEventConstants"),p=a("App.Events.EventCreator");a("Nudoru.Browser.BrowserEventConstants")}c.initialize=d,c.render=e}),define("APP.View.MessageList",function(a,b,c){function d(a){this.isInitialized()||(g=this,this.initializeSubView(a),APP.registerViewForModelChanges("MessagesCollection",this.getID()))}function e(){var a=Object.create(null);a.messages=[],APP.model().getMessagesCollection().forEach(function(b){a.messages.push({username:b.get("username"),content:b.get("content")})}),g.setState(a)}function f(){var a=g.getDOMElement().parentNode;a.scrollTop=a.scrollHeight}var g;c.initialize=d,c.viewWillUpdate=e,c.viewDidMount=f}),define("APP.View.UserList",function(a,b,c){function d(a){this.isInitialized()||(f=this,APP.registerViewForModelChanges("UsersCollection",this.getID()),this.initializeSubView(a))}function e(){var a=Object.create(null);a.users=[],APP.model().getUsersCollection().forEach(function(b){a.users.push(b.get("username"))}),f.setState(a)}var f;c.initialize=d,c.viewWillUpdate=e}),function(){var a=require("Nudoru.Browser.BrowserInfo");a.notSupported||a.isIE9?document.querySelector("body").innerHTML="<h3>For the best experience, please use Internet Explorer 10+, Firefox, Chrome or Safari to view this application.</h3>":window.onload=function(){window.APP=Nori.createApplication(require("APP.Application")),APP.initialize()}}();